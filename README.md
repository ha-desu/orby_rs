Orby v0.1.0 (Alpha) 🌌
```

 ·   ·       ·          ·            ·       ·    ·
   ·   ____        _             ·      ·      ·
 ·    / __ \      | |            ·    ·      ·    ·
    ·| |  | |_ __| |__  _   _    ·       ·      ·
 ·   | |  | | '__| '_ \| | | |  ·    ·      ·    ·
   · | |__| | |  | |_) | |_| |      ·     ·      ·
 ·    \____/|_|  |_.__/ \__, |   ·      ·     ·
   ·   ·       ·        __/ |   ·    ·      ·    ·
 ·      ·    ·         |___/      ·      ·

          .         .           .
```

**Orby（オービィ）** は、128bit 固定長データ（UUID v7/v8 等）の走査・検索に特化した、インメモリ・インデックスエンジンを目指しています。

汎用性をあえて捨て、128bit データのレイアウトを徹底的に最適化することで、高速なスループットを実現しました。現代の分散アーキテクチャが生み出す膨大な ID 群を、光の速さで整理します。

---

### 🚀 Orby の強み

- **⚡️ 走査スピード**
  - 400万件のデータを 13ms で検索できることもあります。ベンチマークでお試しください。
- **🧬 UUID v7 / v8 ネイティブ最適化**
  - 128bit データをネイティブに扱う設計のため、変換オーバーヘッドを最小限に抑えることを目指しています。
- **🔥🔥 Rayon x SIMD (wide)**
  - `Rayon` による全コア並列スキャンと、`wide` クレートを用いた SIMD（ベクトル演算）を活用しています。
- **�️ 堅牢な永続化アーキテクチャ**
  - ノンブロッキングな **AOF** 更新ログと、ミリ秒単位で復元可能な **スナップショット** のハイブリッド構成です。
- **🧠 インテリジェント・キャッシュ管理**
  - CPU キャッシュラインを意識したデータ配置により、メモリアクセスの効率化を目指しています。

---

### 🧪 性能測定の記録（参考値）

M2 MacBook Air (8GB RAM) を使用し、400万件のデータセットに対して検索負荷テストを行った際の結果です。

- **Rust 標準 (HashSet)**: 約 60.4 ms
- **Orby (MemoryOnly)**: **約 13.0 ms ✨**

---

### 🛠 KVSとして使うクイックスタート

```rust
use orby::{Orby, SaveMode, LogicMode};

#[tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>> {
    // エンジンの初期化 (10,000件キャパシティ / 2次元データ)
    let orby = Orby::builder("my_pool")
        .capacity(10_000)
        .dimension(2)
        .with_storage(SaveMode::Sync(Some(path)))
        .build()
        .await?;

    // データの挿入 (UUID v7 もそのまま格納可能)
    let uuid_v7 = 0x018d0000_0000_7000_8000_000000000000u128;
    let record = vec![uuid_v7, 100u128]; // [フィールド0, フィールド1]
    orby.insert_batch(vec![record])?;

    // データの検索: find_by(フィールドIndex, 値のセット, 上限数)
    
    // 例1: 先頭カラム (UUID) が一致するものを検索
    let targets = std::collections::HashSet::from([uuid_v7]);
    let results = orby.find_by(0, &targets, 10);

    // 例2: 2番目のカラム (ユーザーIDなど) が 100 のものを検索
    let user_ids = std::collections::HashSet::from([100u128]);
    let results = orby.find_by(1, &user_ids, 10);

    Ok(())
}
```

---

### 🌟 主要な機能

| ストレージモード | 特徴 | 用途 |
| :--- | :--- | :--- |
| **`MemoryOnly`** | 全データを RAM 上で管理。最速のレスポンス | 短期キャッシュ、リアルタイム集計 |
| **`Sync`** | RAM とファイルの mmap 同期。高速かつ安全 | 一般的なデータベース用途、永続化 |
| **`Direct`** | ファイルを直接読み書き（※低速） | メモリ消費を極限まで抑えたい場合 |

| ロジックモード | 特徴 | 用途 |
| :--- | :--- | :--- |
| **`Ring` 方式** | 古いデータから自動で上書き | タイムライン、直近のログ監視 |
| **`Fixed` 方式** | 固定キャパシティで厳密に管理 | マップデータ、マスターデータ |

---

### ⚠️ 開発ステータス

本プロジェクトは現在 **アルファ版** です。
個人の学習と特定の用途への最適化を目的としており、APIの構成や安定性は今後もダイナミックに変化し続ける予定です。
ご利用の際はコードを確認し、fork して自身のプロジェクトに最適化することを強く推奨します。

© 2026 Everyn Project / Orby Contributors